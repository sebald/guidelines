<!DOCTYPE html><html lang="en"><head>
	<meta charset="UTF-8">
    <meta name="theme-color" content="#814d7c">

	<title>Scroll Rack | Good Practices</title>

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link href="../../theme.css" rel="stylesheet">
    <link href="../../style.css" rel="stylesheet">
</head>
<body>

    <page-menu-toggle>
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" viewBox="-58.5 250.5 118 500" enable-background="new -58.5 250.5 118 500" xml:space="preserve">
    <path d="M0.5 705.4L59.8 750.5V602.5v-92.6V250.5H-58.8v352h0.1L-58.8 750.5 0.5 705.4z"></path>
</svg>

    </page-menu-toggle>

    <page-menu>
        <page-menu-title>Table of Contents</page-menu-title>
        <section-list>
                <section-title><a href="/preface.html">Preface</a></section-title>
                <section-list-title>typescript</section-list-title>
                <ul>
                    <li><a href="/typescript/0_introduction/">Introduction</a></li>
                    <li><a href="/typescript/1_type_system/">Type System</a></li>
                    <li><a href="/typescript/2_declaration_files/">Declaration Files</a></li>
                    <li><a href="/typescript/3_coding_styles/">Coding Styles</a></li>
                </ul>
                <section-list-title>angular</section-list-title>
                <ul>
                    <li><a href="/angular/0_good_practices/">Good Practices</a></li>
                </ul>
        </section-list>
    </page-menu>
    <page-menu-backdrop></page-menu-backdrop>

    <main>
    <article>
    	<h1>Good Practices</h1>
    	<h2 id="banning-ng-controller" class="Header--withAnchor"><a href="#banning-ng-controller" aria-hidden="true">#</a>Banning <code>ng-controller</code></h2>
<p>When you start build­ing apps with An­gu­lar us­ing the <code>ng-controller</code><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> di­rec­tive seems pretty straight for­ward. Just like in every other MVC-style ap­pli­ca­tion, con­trollers are the me­di­a­tors be­tween the model and view.</p>
<p>By adding <code>ng-controller</code> to a DOM el­e­ment, An­gu­lar will cre­ate a new child scope with the el­e­ment as its root. Child scopes pro­to­typ­ally in­herit meth­ods and prop­er­ties from their par­ent. Hence, there is no Shadow DOM<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> or other iso­la­tion. Deep scope hi­er­achies will lead to semi-global data, which make it hard to main­tain and rea­son about your code. Know­ing from where data orig­i­nates will be dif­fi­cult.</p>
<p>In­stead of pol­lut­ing your tem­plates with <code>ng-controller</code> di­rec­tives, rather make use of the <em>component pattern</em>. This pat­tern fo­cuses on di­rec­tives to achive seper­a­tion of con­cerns and high reusablity of code. The next chap­ter will give a thor­ough ex­plaina­tion of the <em>component pattern</em>.</p>
<h2 id="no-scope-soup" class="Header--withAnchor"><a href="#no-scope-soup" aria-hidden="true">#</a>No <code>$scope</code> Soup</h2>
<p>With the in­tro­duc­tion of the <code>controllerAs</code> syn­tax in An­gu­lar 1.2 we fi­nally can get rid of in­ject­ing <code>$scope</code> in each and every con­troller. In fact, to­day it is a best prac­tice to use the <code>controllerAS</code> syn­tax through­out your app.<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p>
<h3 id="controllers" class="Header--withAnchor"><a href="#controllers" aria-hidden="true">#</a>Controllers</h3>
<p>As a re­sult con­trollers can be writ­ten as a <code>class</code>. Or, if you are still writ­ing ES5, can be writ­ten with the con­struc­tor pat­tern.<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> In ei­ther case, writ­ing con­trollers as “classes” al­lows us to only in­ject the <code>$scope</code> ser­vice if it is re­ally nec­es­sary. This lets us write reg­u­lar JavaScript (e.g. use <code>this</code>) and con­trollers are much more light­weight. The fol­low­ing code ex­am­ples show how con­trollers should be ini­tialised:</p>
<pre><code class="hljs javascript"><span class="hljs-comment">// ES5</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SomeController</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.title = <span class="hljs-string">'Some Controller Tittle'</span>;
}

angular
    .module(<span class="hljs-string">'app'</span>, [])
    .controller(<span class="hljs-string">'SomeController'</span>, SomeController);
</code></pre>
<pre><code class="hljs javascript"><span class="hljs-comment">// ES2015</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnotherController</span> () </span>{
    constructor() {
        <span class="hljs-keyword">this</span>.title = <span class="hljs-string">'Some Controller Tittle'</span>;
    }
}

angular
    .module(<span class="hljs-string">'app'</span>, [])
    .controller(<span class="hljs-string">'AnotherController'</span>, AnotherController);
</code></pre>
<h3 id="directives" class="Header--withAnchor"><a href="#directives" aria-hidden="true">#</a>Directives</h3>
<p>Be­fore An­gu­lar 1.3 the <code>controllerAs</code> syn­tax only worked well with con­trollers that are used with a <code>ng-controller</code> di­rec­tive. Us­ing the syn­tax in your own di­rec­tive was a real pain be­cause the bind­ings did­n’t work like you would have ex­pected. To il­lus­trate the prob­lem con­sider the fol­low­ing di­rec­tive:</p>
<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HelloDirectiveConstructor</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// Directive definition object</span>
    <span class="hljs-keyword">return</span> {
        restrict: <span class="hljs-string">'E'</span>,
        template: <span class="hljs-string">'Hello {{ vm.to }}!'</span>,
        scope: {
            to: <span class="hljs-string">'='</span>
        },
        controllerAs: <span class="hljs-string">'vm'</span>,
        controller: HelloDirectiveController
    };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HelloDirectiveController</span> (<span class="hljs-params"> $scope </span>) </span>{
    <span class="hljs-keyword">this</span>.to = $scope.to;
}

angular
    .module(<span class="hljs-string">'app'</span>, [])
    .directive(<span class="hljs-string">'sayHello'</span>, HelloDirectiveConstructor);

</code></pre>
<p>As you might al­ready see, even though we used <code>controllerAs</code> syn­tax and wrote the di­rec­tive as a class-like ob­ject, us­ing <code>$scope</code> was still nec­es­sary. In ad­di­tion, we messed up the two-way bind­ing. If we want to up­date <code>this.to</code> when­ever the <code>to</code> at­tribute bind­ing changes a <code>$watch</code> is re­quired.</p>
<p>For­tu­nately the di­rec­tive de­f­i­n­i­tion ob­ject was ex­tended in An­gu­lar 1.3 with a new prop­erty called <code>bindToController</code>. When set to <code>true</code> in a di­rec­tive that has an iso­lated scope and uses <code>controllerAs</code>, all prop­er­ties are bound to the con­troller rather than the <code>$scope</code>.<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup></p>
<p>In An­gu­lar 1.4 the API was im­proved fur­ther. In­stead of spec­i­fy­ing bound prop­er­ties in the <code>scope</code> de­f­i­n­i­tion, you can now put all bind­ing di­rectly into <code>bindToController</code>. Fur­ther­more, start­ing with An­gu­lar 1.4 us­ing <code>bindToController</code> is also al­lowed on di­rec­tives that in­tro­duce a new scope.<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup></p>
<p>The <code>HelloDirectiveConstructor</code> should be refac­tored like this:</p>
<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HelloDirectiveConstructor</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> {
        restrict: <span class="hljs-string">'E'</span>,
        template: <span class="hljs-string">'Hello {{ vm.to }}!'</span>,
        scope: {},
        controllerAs: <span class="hljs-string">'vm'</span>,
        controller: HelloDirectiveController,
        bindToController: {
            to: <span class="hljs-string">'='</span>
        }
    };
}
</code></pre>
<h2 id="the-viewmodel-convention" class="Header--withAnchor"><a href="#the-viewmodel-convention" aria-hidden="true">#</a>The “ViewModel” Convention</h2>
<p>Be­cause of John Pa­pa’s in­fa­mous styleguide<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> (and right­fully so) the An­gu­lar com­mu­nity started to use a con­si­tent nam­ing con­ven­tion for alias­ing con­trollers: <code>vm</code> also known as the “View­Model”. The rea­son to use a ded­i­cated vari­able in­stead of the <code>this</code> key­word is alawys the same (in JavaScript). This is con­tex­tual<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> and func­tions in­side your con­trollers will cre­ate a new con­text, hence <code>this</code> in­side a func­tion will not be the same as the <code>this</code> of your con­troller. The only ex­pec­tion for this is of courese if you <code>.bind</code> your func­tion.<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup></p>
<p>Us­ing <code>vm</code> will also make it very clear what mem­bers are ex­ported and can be ac­cessed from out­side the con­troller. You should al­ways list ex­ported vari­ables and meth­ods at the top of a con­troller and place the logic be­low:</p>
<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SomeController</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> vm = <span class="hljs-keyword">this</span>;

    <span class="hljs-comment">// Exports</span>
    vm.title = <span class="hljs-string">'Some Controller'</span>;
    vm.list = [];

    vm.someFunction = someFunction;

    <span class="hljs-comment">// Here come the controller logic</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">someFunction</span> (<span class="hljs-params"></span>) </span>{ ... }
}
</code></pre>
<p>So make your­self a fa­vor and al­ways use <code>vm</code> to ref­er­ence your con­troller’s con­text. Be­cause it com­monly used by An­gu­lar de­vel­op­ers it will be eas­ier for other peo­ple to rea­son about your code.</p>
<hr>
<p><strong>TODO</strong></p>
<ul>
<li>use directive controller whenever possible</li>
<li>controllers should never directly request stuff from the server → <a href="https://github.com/johnpapa/angular-styleguide#defer-controller-logic-to-services">https://github.com/johnpapa/angular-styleguide#defer-controller-logic-to-services</a></li>
</ul>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://docs.angularjs.org/api/ng/directive/ngController">Angular Docs: <code>ng-controller</code></a> <a href="#fnref1" class="footnote-backref">↩</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM">MDN - Shadow DOM</a> <a href="#fnref2" class="footnote-backref">↩</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="http://blog.thoughtram.io/angularjs/2015/01/02/exploring-angular-1.3-bindToController.html">Pascal Precht - Exploring Angular 1.3: Binding to Directive Controllers</a> <a href="#fnref3" class="footnote-backref">↩</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/#constructorpatternjavascript">Addy Osmani - Learning JavaScript Design Patterns</a> <a href="#fnref4" class="footnote-backref">↩</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="http://toddmotto.com/no-scope-soup-bind-to-controller-angularjs/">Todd Motto - No $scope soup, bindToController in AngularJS</a> <a href="#fnref5" class="footnote-backref">↩</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://github.com/angular/angular.js/commit/35498d7045ba9138016464a344e2c145ce5264c1">Angular Commit: <code>bindToController</code></a> <a href="#fnref6" class="footnote-backref">↩</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://github.com/johnpapa/angular-styleguide">John Papa - Angular Style Guide</a> <a href="#fnref7" class="footnote-backref">↩</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Operators/this">MDN - <code>this</code></a> <a href="#fnref8" class="footnote-backref">↩</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">MDN - <code>Function.prototype.bind()</code></a> <a href="#fnref9" class="footnote-backref">↩</a></p>
</li>
</ol>
</section>

    </article>
    <article-footer>
        <div class="Article-prev">
            <a class="Article-link" data-title="Coding Styles" href="../../typescript/3_coding_styles/">
                <svg height="48" viewBox="0 0 24 24" width="48" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path>
</svg>
            </a>
        </div>
    </article-footer>

        <footer-push></footer-push>
    </main>
    <footer>
        <time datetime="Wed Aug 05 2015 00:19:56 GMT+0200 (CEST)">Wed Aug 05 2015 00:19:56 GMT+0200 (CEST)</time>
    </footer>

    <script src="../../main.js"></script>
    <script src="http://localhost:35729/livereload.js"></script>

</body></html>